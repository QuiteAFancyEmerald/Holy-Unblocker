(()=>{var e={129:function(e,r,t){t.d(r,{u:()=>c});var o=t(9777),n=t(1762).Z;class c extends EventTarget{controller;frame;constructor(e,r){super(),this.controller=e,this.frame=r,r.name=o.q5,r[o.D1]=this}get client(){return this.frame.contentWindow.window[o.a3]}get url(){return this.client.url}go(e){e instanceof URL&&(e=e.toString()),n.log("navigated to",e),this.frame.src=this.controller.encodeUrl(e)}back(){this.frame.contentWindow?.history.back()}forward(){this.frame.contentWindow?.history.forward()}reload(){this.frame.contentWindow?.location.reload()}addEventListener(e,r,t){super.addEventListener(e,r,t)}}},1762:function(e,r,t){t.d(r,{Z:()=>c});var o=t(8810);let n={log:console.log,warn:console.warn,error:console.error,debug:console.debug,info:console.info},c={fmt:function(e,r,...t){let o=Error.prepareStackTrace;Error.prepareStackTrace=(e,r)=>{r.shift(),r.shift(),r.shift();let t="";for(let e=1;e<Math.min(2,r.length);e++)r[e].getFunctionName()&&(t+=`${r[e].getFunctionName()} -> `+t);return t+(r[0].getFunctionName()||"Anonymous")};let n=function(){try{throw Error()}catch(e){return e.stack}}();Error.prepareStackTrace=o,this.print(e,n,r,...t)},print(e,r,t,...o){(n[e]||n.log)(`%c${r}%c ${t}`,`
  	background-color: ${{log:"#000",warn:"#f80",error:"#f00",debug:"transparent"}[e]};
  	color: ${{log:"#fff",warn:"#fff",error:"#fff",debug:"gray"}[e]};
  	padding: ${{log:2,warn:4,error:4,debug:0}[e]}px;
  	font-weight: bold;
  	font-family: monospace;
  	font-size: 0.9em;
  `,`${"debug"===e?"color: gray":""}`,...o)},log:function(e,...r){this.fmt("log",e,...r)},warn:function(e,...r){this.fmt("warn",e,...r)},error:function(e,...r){this.fmt("error",e,...r)},debug:function(e,...r){this.fmt("debug",e,...r)},time(e,r,t){let n;if(!(0,o.Sp)("rewriterLogs",e.base))return;let c=performance.now()-r;n=c<1?"BLAZINGLY FAST":c<500?"decent speed":"really slow",this.print("debug","[time]",`${t} was ${n} (${c.toFixed(2)}ms)`)}}},8810:function(e,r,t){t.d(r,{Sp:()=>s,h3:()=>o,t8:()=>c}),"$scramjet"in self||(self.$scramjet={version:{build:"d63f8a7",version:"1.0.2-dev"},codec:{},flagEnabled:s});let o=self.$scramjet,n=Function;function c(){o.codec.encode=n(`return ${o.config.codec.encode}`)(),o.codec.decode=n(`return ${o.config.codec.decode}`)()}function s(e,r){let t=o.config.flags[e];for(let t in o.config.siteFlags){let n=o.config.siteFlags[t];if(new RegExp(t).test(r.href)&&e in n)return n[e]}return t}},9777:function(e,r,t){t.d(r,{D1:()=>n,a3:()=>o,q5:()=>c});let o=Symbol.for("scramjet client global"),n=Symbol.for("scramjet frame handle"),c="scramjet_frame"}},r={};function t(o){var n=r[o];if(void 0!==n)return n.exports;var c=r[o]={exports:{}};return e[o](c,c.exports,t),c.exports}t.d=(e,r)=>{for(var o in r)t.o(r,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:r[o]})},t.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),(()=>{var e=t(129),r=t(8810),o=t(1762).Z;window.ScramjetController=class{db;constructor(e){let t=(e,r)=>{for(let o in r)r[o]instanceof Object&&o in e&&Object.assign(r[o],t(e[o],r[o]));return Object.assign(e||{},r)},o=t({prefix:"/scramjet/",globals:{wrapfn:"$scramjet$wrap",wrapthisfn:"$scramjet$wrapthis",trysetfn:"$scramjet$tryset",importfn:"$scramjet$import",rewritefn:"$scramjet$rewrite",metafn:"$scramjet$meta",setrealmfn:"$scramjet$setrealm",pushsourcemapfn:"$scramjet$pushsourcemap"},files:{wasm:"/scramjet.wasm.js",shared:"/scramjet.shared.js",worker:"/scramjet.worker.js",client:"/scramjet.client.js",sync:"/scramjet.sync.js"},flags:{serviceworkers:!1,syncxhr:!1,naiiveRewriter:!1,strictRewrites:!0,rewriterLogs:!1,captureErrors:!0,cleanErrors:!1,scramitize:!1,sourcemaps:!0},siteFlags:{},codec:{encode:e=>e?encodeURIComponent(e):e,decode:e=>e?decodeURIComponent(e):e}},e);o.codec.encode=o.codec.encode.toString(),o.codec.decode=o.codec.decode.toString(),r.h3.config=o}async init(){(0,r.t8)(),await this.openIDB(),navigator.serviceWorker.controller?.postMessage({scramjet$type:"loadConfig",config:r.h3.config}),o.log("config loaded")}createFrame(r){return r||(r=document.createElement("iframe")),new e.u(this,r)}encodeUrl(e){return e instanceof URL&&(e=e.toString()),r.h3.config.prefix+r.h3.codec.encode(e)}decodeUrl(e){return e instanceof URL&&(e=e.toString()),r.h3.codec.decode(e)}async openIDB(){let e=indexedDB.open("$scramjet",1);return new Promise((r,t)=>{e.onsuccess=async()=>{this.db=e.result,await this.#e(),r(e.result)},e.onupgradeneeded=()=>{let r=e.result;r.objectStoreNames.contains("config")||r.createObjectStore("config"),r.objectStoreNames.contains("cookies")||r.createObjectStore("cookies"),r.objectStoreNames.contains("redirectTrackers")||r.createObjectStore("redirectTrackers"),r.objectStoreNames.contains("referrerPolicies")||r.createObjectStore("referrerPolicies"),r.objectStoreNames.contains("publicSuffixList")||r.createObjectStore("publicSuffixList")},e.onerror=()=>t(e.error)})}async #e(){if(!this.db)return void console.error("Store not ready!");let e=this.db.transaction("config","readwrite").objectStore("config").put(r.h3.config,"config");return new Promise((r,t)=>{e.onsuccess=r,e.onerror=t})}async modifyConfig(e){r.h3.config=Object.assign({},r.h3.config,e),(0,r.t8)(),await this.#e()}}})()})();
//# sourceMappingURL=scramjet.controller.js.map